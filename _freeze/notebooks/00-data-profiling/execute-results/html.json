{
  "hash": "995891bd0b6b0c240522683585a7cdc7",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Data Profiling: WhatsApp Export\"\nsubtitle: \"InvestigaÃ§Ã£o sistemÃ¡tica da estrutura do arquivo bruto\"\nauthor: \"Marlon\"\ndate: today\njupyter: whatsapp-ds\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    code-fold: true\n    theme: cosmo\nexecute:\n  warning: false\n  echo: true\n---\n\n::: {#setup .cell execution_count=1}\n``` {.python .cell-code code-fold=\"false\"}\nimport sys\nfrom pathlib import Path\n\n# Path absoluto (mais confiÃ¡vel)\nPROJECT_ROOT = Path('/Users/mosx/Desktop/whatsapp-ds-analytics')\nsys.path.insert(0, str(PROJECT_ROOT / 'src'))\n\nimport pandas as pd\nfrom profiling import get_lines_at_position, get_lines_containing, get_lines_matching, count_pattern, get_file_overview\n\n# Path do arquivo raw\nRAW_FILE = PROJECT_ROOT / 'data' / 'raw' / 'export_2024-10_2025-10' / 'raw-data.txt'\n\nprint(f\"ğŸ“ Projeto: {PROJECT_ROOT}\")\nprint(f\"ğŸ“„ Arquivo: {RAW_FILE}\")\nprint(f\"âœ… Existe: {RAW_FILE.exists()}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nğŸ“ Projeto: /Users/mosx/Desktop/whatsapp-ds-analytics\nğŸ“„ Arquivo: /Users/mosx/Desktop/whatsapp-ds-analytics/data/raw/export_2024-10_2025-10/raw-data.txt\nâœ… Existe: True\n```\n:::\n:::\n\n\n# IntroduÃ§Ã£o\n\n**Data Profiling** Ã© a primeira etapa de qualquer projeto de dados: investigar sistematicamente o arquivo bruto para entender sua estrutura, padrÃµes e anomalias â€” *antes* de limpar ou transformar qualquer coisa.\n\nEste documento registra as descobertas sobre o formato de exportaÃ§Ã£o do WhatsApp, servindo como referÃªncia para as decisÃµes de limpeza e parsing implementadas nas etapas seguintes.\n\n---\n\n# VisÃ£o Geral do Arquivo\n\n## Metadados BÃ¡sicos\n\n::: {#cell-file-metadata .cell execution_count=2}\n``` {.python .cell-code}\nfrom profiling import get_file_overview\n\nget_file_overview(RAW_FILE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n============================================================\nğŸ“Š VISÃƒO GERAL DO ARQUIVO\n============================================================\nğŸ“„ Arquivo: /Users/mosx/Desktop/whatsapp-ds-analytics/data/raw/export_2024-10_2025-10/raw-data.txt\nğŸ’¾ Tamanho: 5.04 MB (5,284,569 bytes)\nğŸ“ Linhas: 97,333 (vazias: 1,156)\nğŸ”¤ Caracteres: 4,846,244\nğŸ“ MÃ©dia chars/linha: 49.8\n============================================================\n```\n:::\n\n::: {#file-metadata .cell-output .cell-output-display execution_count=2}\n```\n{'arquivo': PosixPath('/Users/mosx/Desktop/whatsapp-ds-analytics/data/raw/export_2024-10_2025-10/raw-data.txt'),\n 'tamanho_bytes': 5284569,\n 'tamanho_formatted': '5.04 MB',\n 'total_linhas': 97333,\n 'linhas_nao_vazias': 96177,\n 'linhas_vazias': 1156,\n 'total_caracteres': 4846244,\n 'media_chars_por_linha': 49.8}\n```\n:::\n:::\n\n\n## Amostra do ConteÃºdo\n\n::: {#cell-content-sample .cell execution_count=3}\n``` {.python .cell-code}\n# Primeiras linhas\nprint(\"ğŸ“„ INÃCIO DO ARQUIVO\")\nprint(\"=\" * 80)\nget_lines_at_position(RAW_FILE, position=0, n=5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nğŸ“„ INÃCIO DO ARQUIVO\n================================================================================\n```\n:::\n\n::: {#content-sample .cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>[19/10/24, 13:52:51] Marlon: Le?</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>[19/10/24, 13:53:25] LÃª ğŸ–¤: https://www.localiz...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>â€[19/10/24, 13:53:25] Marlon: â€image omitted</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>â€[19/10/24, 13:53:41] LÃª ğŸ–¤: â€sticker omitted</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>[19/10/24, 13:53:43] LÃª ğŸ–¤: Oi</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#61783449 .cell execution_count=4}\n``` {.python .cell-code}\n# Meio do arquivo\nprint(\"\\nğŸ“„ MEIO DO ARQUIVO (~50%)\")\nprint(\"=\" * 80)\nget_lines_at_position(RAW_FILE, position=50, n=5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nğŸ“„ MEIO DO ARQUIVO (~50%)\n================================================================================\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>48667</td>\n      <td>[27/06/25, 17:38:25] Marlon: Sim, conheÃ§o o te...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>48668</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>48669</td>\n      <td>NÃ£o hÃ¡ uma traduÃ§Ã£o literal exata para folgado...</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>48670</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>48671</td>\n      <td>â¸»</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#043476ed .cell execution_count=5}\n``` {.python .cell-code}\n# Final do arquivo\nprint(\"\\nğŸ“„ FINAL DO ARQUIVO\")\nprint(\"=\" * 80)\nget_lines_at_position(RAW_FILE, position=100, n=5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nğŸ“„ FINAL DO ARQUIVO\n================================================================================\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>97329</td>\n      <td>[20/10/25, 15:23:29] LÃª ğŸ–¤: Dominou meus pensam...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>97330</td>\n      <td>[20/10/25, 15:23:30] Marlon: VocÃª o meu</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>97331</td>\n      <td>[20/10/25, 15:24:04] Marlon: Meu core eh seu m...</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>97332</td>\n      <td>[20/10/25, 15:25:10] Marlon: Sou seu</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>97333</td>\n      <td>â€[20/10/25, 15:25:49] Marlon: â€&lt;attached: 0000...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n---\n\n# Elementos Estruturais\n\n## Timestamps\n\nO formato padrÃ£o de timestamp Ã© `[DD/MM/YY, HH:MM:SS]`.\n\n::: {#cell-timestamp-pattern .cell execution_count=6}\n``` {.python .cell-code}\n# Contagem de linhas com timestamp vÃ¡lido\npattern_timestamp = r'^\\[\\d{2}/\\d{2}/\\d{2}, \\d{2}:\\d{2}:\\d{2}\\]'\ncount_pattern(RAW_FILE, pattern_timestamp)\n```\n\n::: {#timestamp-pattern .cell-output .cell-output-display execution_count=6}\n```\n{'total_ocorrencias': 68036, 'linhas_com_pattern': 68036}\n```\n:::\n:::\n\n\n::: {.callout-note}\nO formato pode variar dependendo das configuraÃ§Ãµes regionais do dispositivo que exportou.\n:::\n\n---\n\n## Remetentes\n\nApÃ³s o timestamp, o nome do remetente aparece seguido de dois pontos (`:`).\n\n::: {#cell-sender-examples .cell execution_count=7}\n``` {.python .cell-code}\n# Exemplos de diferentes remetentes\nget_lines_at_position(RAW_FILE, position=10, n=3)\n```\n\n::: {#sender-examples .cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>9734</td>\n      <td>â€[04/01/25, 17:26:26] Marlon: â€image omitted</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>9735</td>\n      <td>[04/01/25, 17:26:33] Marlon: Vou voltar todo t...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>9736</td>\n      <td>[04/01/25, 17:26:46] LÃª ğŸ–¤: https://www.instagr...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.callout-tip}\nRemetentes podem conter **emojis** e **caracteres especiais** (ex: `LÃª ğŸ–¤`). O parser precisa considerar isso.\n:::\n\n---\n\n## Caractere InvisÃ­vel U+200E\n\nO caractere `U+200E` (Left-to-Right Mark) aparece frequentemente no export. Ã‰ um caractere de controle de direÃ§Ã£o de texto.\n\n::: {#u200e-analysis .cell execution_count=8}\n``` {.python .cell-code}\n# Quantas ocorrÃªncias existem?\nstats_u200e = count_pattern(RAW_FILE, '\\u200e')\nprint(f\"ğŸ“Š EstatÃ­sticas do U+200E:\")\nprint(f\"   â€¢ Total de ocorrÃªncias: {stats_u200e['total_ocorrencias']:,}\")\nprint(f\"   â€¢ Linhas afetadas: {stats_u200e['linhas_com_pattern']:,}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nğŸ“Š EstatÃ­sticas do U+200E:\n   â€¢ Total de ocorrÃªncias: 48,699\n   â€¢ Linhas afetadas: 24,716\n```\n:::\n:::\n\n\n::: {#c179cbe8 .cell execution_count=9}\n``` {.python .cell-code}\n# Exemplos de onde aparece\nprint(\"\\nğŸ” Exemplos de linhas com U+200E:\")\nget_lines_containing(RAW_FILE, '\\u200e', n=5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nğŸ” Exemplos de linhas com U+200E:\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>3</td>\n      <td>â€[19/10/24, 13:53:25] Marlon: â€image omitted</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>4</td>\n      <td>â€[19/10/24, 13:53:41] LÃª ğŸ–¤: â€sticker omitted</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>6</td>\n      <td>â€[19/10/24, 13:54:34] Marlon: â€image omitted</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>7</td>\n      <td>â€[19/10/24, 13:56:05] Marlon: â€image omitted</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>12</td>\n      <td>â€[19/10/24, 13:57:32] Marlon: â€image omitted</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.callout-warning}\n### DecisÃ£o de Cleaning\nEste caractere serÃ¡ **removido** na etapa de limpeza pois:\n\n- NÃ£o carrega informaÃ§Ã£o semÃ¢ntica Ãºtil\n- Complica o parsing com regex\n- Representa ~4.6% do tamanho do arquivo\n:::\n\n---\n\n## Linhas de ContinuaÃ§Ã£o\n\nMensagens longas podem ocupar mÃºltiplas linhas. Linhas sem timestamp sÃ£o continuaÃ§Ãµes da mensagem anterior.\n\n::: {#cell-multiline-examples .cell execution_count=10}\n``` {.python .cell-code}\n# Linhas que NÃƒO comeÃ§am com timestamp (continuaÃ§Ãµes)\npattern_no_timestamp = r'^(?!\\[?\\d{2}/\\d{2}/\\d{2})'\ncount_pattern(RAW_FILE, pattern_no_timestamp)\n```\n\n::: {#multiline-examples .cell-output .cell-output-display execution_count=10}\n```\n{'total_ocorrencias': 29297, 'linhas_com_pattern': 29297}\n```\n:::\n:::\n\n\n::: {.callout-tip}\n### DecisÃ£o de Wrangling\nO parser deve **agregar** linhas de continuaÃ§Ã£o ao conteÃºdo da mensagem anterior, preservando quebras de linha originais.\n:::\n\n---\n\n# Taxonomia de Mensagens\n\n## Mensagens de Texto\n\n### Texto Puro\n\n::: {#cell-text-pure .cell execution_count=11}\n``` {.python .cell-code}\n# Mensagens simples (sem mÃ­dia, sem marcadores especiais)\nget_lines_matching(RAW_FILE, r'\\] .+?: [A-Za-zÃ€-Ãº]', n=3)\n```\n\n::: {#text-pure .cell-output .cell-output-display execution_count=11}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>[19/10/24, 13:52:51] Marlon: Le?</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>[19/10/24, 13:53:25] LÃª ğŸ–¤: https://www.localiz...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>5</td>\n      <td>[19/10/24, 13:53:43] LÃª ğŸ–¤: Oi</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Texto com Emojis\n\n::: {#cell-text-emoji .cell execution_count=12}\n``` {.python .cell-code}\n# Mensagens contendo emojis comuns\nget_lines_containing(RAW_FILE, 'ğŸ˜‚', n=2)\nget_lines_containing(RAW_FILE, 'â¤', n=2)\n```\n\n::: {#text-emoji .cell-output .cell-output-display execution_count=12}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2258</td>\n      <td>[10/12/24, 16:28:34] Marlon: Ta mara â¤ï¸ bora q...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>3883</td>\n      <td>[24/12/24, 14:56:55] Marlon: Te amo â¤ï¸</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Texto com Links\n\n::: {#cell-text-links .cell execution_count=13}\n``` {.python .cell-code}\n# Mensagens com URLs\nget_lines_matching(RAW_FILE, r'https?://', n=3)\n```\n\n::: {#text-links .cell-output .cell-output-display execution_count=13}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2</td>\n      <td>[19/10/24, 13:53:25] LÃª ğŸ–¤: https://www.localiz...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>26</td>\n      <td>[19/10/24, 14:23:23] Marlon: https://www.airbn...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>209</td>\n      <td>[22/11/24, 17:59:35] LÃª ğŸ–¤: https://www.airbnb....</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n---\n\n## Mensagens de MÃ­dia\n\n### MÃ­dias Omitidas\n\nQuando o export nÃ£o inclui os arquivos de mÃ­dia:\n\n::: {#media-omitted .cell execution_count=14}\n``` {.python .cell-code}\ntipos_omitidos = ['audio omitted', 'image omitted', 'video omitted', \n                  'sticker omitted', 'GIF omitted', 'document omitted']\n\nprint(\"ğŸ“Š Contagem de mÃ­dias omitidas:\\n\")\nfor tipo in tipos_omitidos:\n    stats = count_pattern(RAW_FILE, tipo)\n    if stats['total_ocorrencias'] > 0:\n        print(f\"   â€¢ {tipo}: {stats['total_ocorrencias']:,}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nğŸ“Š Contagem de mÃ­dias omitidas:\n\n   â€¢ audio omitted: 8,040\n   â€¢ image omitted: 3,287\n   â€¢ video omitted: 248\n   â€¢ sticker omitted: 1,869\n   â€¢ GIF omitted: 28\n   â€¢ document omitted: 38\n```\n:::\n:::\n\n\n::: {#8bd4287f .cell execution_count=15}\n``` {.python .cell-code}\n# Exemplos\nprint(\"\\nğŸ” Exemplos de mÃ­dia omitida:\")\nget_lines_containing(RAW_FILE, 'audio omitted', n=2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nğŸ” Exemplos de mÃ­dia omitida:\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>18</td>\n      <td>â€[19/10/24, 14:11:39] Marlon: â€audio omitted</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>23</td>\n      <td>â€[19/10/24, 14:17:39] Marlon: â€audio omitted</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### MÃ­dias Anexadas\n\nQuando o export inclui os arquivos:\n\n::: {#media-attached .cell execution_count=16}\n``` {.python .cell-code}\n# PadrÃ£o: <attached: FILENAME.ext>\nstats_attached = count_pattern(RAW_FILE, r'<attached:')\nprint(f\"ğŸ“Š MÃ­dias anexadas: {stats_attached['total_ocorrencias']:,}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nğŸ“Š MÃ­dias anexadas: 1,254\n```\n:::\n:::\n\n\n::: {#70a87068 .cell execution_count=17}\n``` {.python .cell-code}\n# Exemplos por tipo\nprint(\"\\nğŸ” Exemplos de mÃ­dia anexada:\")\nget_lines_matching(RAW_FILE, r'<attached:.*\\.opus>', n=2)  # Ãudio\nget_lines_matching(RAW_FILE, r'<attached:.*\\.jpg>', n=2)   # Imagem\nget_lines_matching(RAW_FILE, r'<attached:.*\\.mp4>', n=2)   # VÃ­deo\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nğŸ” Exemplos de mÃ­dia anexada:\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>90360</td>\n      <td>â€[28/08/25, 11:52:19] Marlon: â€&lt;attached: 0000...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>90845</td>\n      <td>â€[03/09/25, 13:50:06] LÃª ğŸ–¤: â€&lt;attached: 000012...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.callout-note}\n### PadrÃ£o de nomenclatura dos arquivos\n`NÃšMERO-TIPO-DATA-HORA.extensÃ£o`\n\nExemplo: `00000001-AUDIO-2025-08-21-21-31-39.opus`\n:::\n\n---\n\n## Mensagens Especiais\n\n### Mensagens Editadas\n\n::: {#cell-msg-edited .cell execution_count=18}\n``` {.python .cell-code}\nstats_edited = count_pattern(RAW_FILE, r'<This message was edited>')\nprint(f\"ğŸ“Š Mensagens editadas: {stats_edited['total_ocorrencias']:,}\")\n\nget_lines_containing(RAW_FILE, '<This message was edited>', n=2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nğŸ“Š Mensagens editadas: 658\n```\n:::\n\n::: {#msg-edited .cell-output .cell-output-display execution_count=18}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1315</td>\n      <td>Mano! O cara fica quase 3 meses fora. Pensei q...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1834</td>\n      <td>[06/12/24, 21:42:55] LÃª ğŸ–¤: Bora da rolÃª â€&lt;This...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Mensagens Deletadas\n\n::: {#cell-msg-deleted .cell execution_count=19}\n``` {.python .cell-code}\nstats_deleted = count_pattern(RAW_FILE, r'This message was deleted')\nprint(f\"ğŸ“Š Mensagens deletadas: {stats_deleted['total_ocorrencias']:,}\")\n\nget_lines_containing(RAW_FILE, 'This message was deleted', n=2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nğŸ“Š Mensagens deletadas: 22\n```\n:::\n\n::: {#msg-deleted .cell-output .cell-output-display execution_count=19}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>255</td>\n      <td>[22/11/24, 19:15:43] LÃª ğŸ–¤: â€This message was d...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>3890</td>\n      <td>[24/12/24, 16:19:59] LÃª ğŸ–¤: â€This message was d...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Chamadas de Voz/VÃ­deo\n\n::: {#cell-msg-calls .cell execution_count=20}\n``` {.python .cell-code}\nstats_calls = count_pattern(RAW_FILE, r'(Missed|Voice|Video) (voice |video )?call')\nprint(f\"ğŸ“Š Registros de chamadas: {stats_calls['total_ocorrencias']:,}\")\n\nget_lines_containing(RAW_FILE, 'call', n=3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nğŸ“Š Registros de chamadas: 13\n```\n:::\n\n::: {#msg-calls .cell-output .cell-output-display execution_count=20}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>linha</th>\n      <th>conteudo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>927</td>\n      <td>Mas um amigo disse q primeiro eu tinha q assis...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>90434</td>\n      <td>[29/08/25, 16:42:37] LÃª ğŸ–¤: â€Missed voice call....</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>90858</td>\n      <td>[03/09/25, 15:04:55] LÃª ğŸ–¤: â€Missed voice call....</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n---\n\n# Resumo das Descobertas\n\n## DecisÃµes para Data Cleaning\n\n| Descoberta | DecisÃ£o |\n|------------|---------|\n| Caractere U+200E em ~50% das linhas | Remover todas ocorrÃªncias |\n| Timestamps vazios ocasionais | Remover linhas |\n| Linhas completamente vazias | Remover |\n| EspaÃ§os mÃºltiplos | Normalizar para espaÃ§o Ãºnico |\n| Nomes dos participantes | Anonimizar (P1, P2) |\n| Formato timestamp `[DD/MM/YY, HH:MM:SS]` | Simplificar para `DD/MM/YY HH:MM:SS` |\n\n## DecisÃµes para Data Wrangling\n\n| Descoberta | DecisÃ£o |\n|------------|---------|\n| Linhas de continuaÃ§Ã£o (multi-linha) | Agregar ao conteÃºdo da mensagem anterior |\n| MÃ­dias omitidas vs anexadas | Classificar em `status_midia` |\n| Arquivos fÃ­sicos de mÃ­dia | Vincular pelo nome do arquivo |\n| Ãudios e vÃ­deos anexados | Transcrever via API (Groq/Whisper) |\n\n## PadrÃµes Regex NecessÃ¡rios\n\n```python\n# Timestamp\nr'^\\[(\\d{2}/\\d{2}/\\d{2}), (\\d{2}:\\d{2}:\\d{2})\\]'\n\n# Mensagem completa (apÃ³s otimizaÃ§Ã£o)\nr'^(\\d{2}/\\d{2}/\\d{2}) (\\d{2}:\\d{2}:\\d{2}) (.+?): (.*)$'\n\n# MÃ­dia omitida\nr'(audio|image|video|sticker|GIF|document) omitted'\n\n# MÃ­dia anexada\nr'<attached: (.+?)>'\n```\n\n---\n\n# PrÃ³ximos Passos\n\nCom o profiling completo, seguimos para:\n\n1. **[Data Preparation](01-data-preparation.qmd)** â€” Implementar cleaning, parsing e feature engineering\n2. **[EDA](02-eda.qmd)** â€” AnÃ¡lise exploratÃ³ria do DataFrame estruturado\n\n",
    "supporting": [
      "00-data-profiling_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}